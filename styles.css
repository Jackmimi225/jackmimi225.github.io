*{box-sizing:border-box}
:root{
  --size:260px;                    /* 组件整体尺寸（可改） */
  --edge:#2f3a4f;                  /* 面边线颜色 */
  --ink:#e5e7eb;
  --grid: repeating-linear-gradient(0deg, rgba(255,255,255,.08) 0 1px, transparent 1px 12px),
          repeating-linear-gradient(90deg, rgba(255,255,255,.08) 0 1px, transparent 1px 12px);
}
html,body{height:100%}
body{
  margin:0;
  background:radial-gradient(1100px 680px at 20% -20%, #243b7a 18%, transparent 60%), #0b0f1a;
  color:var(--ink);
}
.stage{position:fixed; inset:0}
.viewport{position:absolute; inset:0; perspective:1100px; overflow:hidden}
.viewport.flat{ perspective:none }

/* 防选中/手势 */
html, body, .stage, .viewport, .dice, .poly, .solid3d { touch-action:none; }
.dice, .poly, .solid3d{ -webkit-user-select:none; user-select:none; -webkit-user-drag:none; }
.dice,.poly{ cursor:grab }
.poly.grab{ cursor:grabbing }

/* 初始居中（JS 会转成像素定位） */
.dice{
  position:absolute; width:var(--size); height:var(--size);
  left:calc(50vw - var(--size)/2); top:calc(50vh - var(--size)/2);
  transform:translate(0,0);
}

/* 掷出数字徽章（显示 2.5s） */
.badge{
  position:absolute; left:50%; top:50%; translate:-50% -50%;
  min-width:96px; padding:.35rem .75rem; border-radius:14px;
  background:#111827; color:#fefefe; font-size:48px; font-weight:900;
  border:1px solid #374151; box-shadow:0 10px 30px rgba(0,0,0,.45);
  pointer-events:none; z-index:5;
}
.badge[hidden]{ display:none!important }

/* ===== 折叠态：真正的 cuboctahedron ===== */
.poly{ position:absolute; inset:0; transform-style:preserve-3d; transition:transform 1s cubic-bezier(.2,.8,.2,1); z-index:1; }
.solid3d{ position:absolute; inset:0; transform-style:preserve-3d; }

/* 单个 3D 面的容器（放置在中心，通过 3D 旋转+Z 位移到正确位置） */
.face3d{ position:absolute; left:50%; top:50%; transform-style:preserve-3d; }

/* 面的 2D 形状（放在面容器内部居中） */
.sq2d,.tri2d{ position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); }
.sq2d{
  width:var(--a); height:var(--a);
  background:
    radial-gradient(120% 120% at 30% 20%, rgba(255,255,255,.28), rgba(255,255,255,0) 60%),
    var(--grid),
    linear-gradient(135deg,#e9eefb,#c8d1ef);
  border:2px solid var(--edge);
  border-radius:10px;
}
.tri2d{
  width:var(--a); height:calc(var(--a)*0.8660254); /* √3/2 */
  clip-path:polygon(50% 0%, 100% 100%, 0% 100%);
  background:
    radial-gradient(120% 120% at 30% 20%, rgba(255,255,255,.25), rgba(255,255,255,0) 60%),
    var(--grid),
    linear-gradient(135deg,#dde6ff,#bcc9ff);
  border:2px solid var(--edge);
  border-bottom-left-radius:10px; border-bottom-right-radius:10px;
}

/* 展开：折叠体淡出；仅展开时显示网 */
.poly.unfold .solid3d{ opacity:0; pointer-events:none; transition:opacity .25s ease; }
.poly.unfold{ transform:none !important; transform-style:flat; }
.net{
  position:absolute; left:calc(-1*var(--size)); top:calc(-1*var(--size));
  width:calc(var(--size)*3); height:calc(var(--size)*4);
  opacity:0; visibility:hidden; pointer-events:none;
  transition:opacity .35s ease .05s, visibility 0s linear .35s;
  z-index:0;
}
.viewport.flat .net{ opacity:1; visibility:visible; pointer-events:auto; transition:opacity .35s ease .05s, visibility 0s; }

/* 展开网：6 个编号方格（走步目标） */
.cell{ position:absolute; display:grid; place-items:center; font-weight:900; color:#0f172a; }
.sqC{
  width:var(--size); height:var(--size); border-radius:16px;
  background:
    linear-gradient(180deg, rgba(255,255,255,.12), rgba(0,0,0,.0)),
    var(--grid),
    linear-gradient(135deg,#e6ebff,#c5d0ff);
  border:2px solid rgba(255,255,255,.35);
  outline:1px dashed rgba(0,0,0,.08); outline-offset:-6px;
}
.sqC span{ font-size:56px; }

/* 与你提供的“星形+链条”网接近的布局；可按需要微调 */
.s1{ left:calc(1*var(--size)); top:calc(1*var(--size)); } /* 中心 */
.s2{ left:calc(1*var(--size)); top:calc(0*var(--size)); } /* 上 */
.s3{ left:calc(2*var(--size)); top:calc(1*var(--size)); } /* 右 */
.s4{ left:calc(0*var(--size)); top:calc(1*var(--size)); } /* 左 */
.s5{ left:calc(1*var(--size)); top:calc(2*var(--size)); } /* 下 */
.s6{ left:calc(1*var(--size)); top:calc(3*var(--size)); } /* 下下（链） */

/* 展开网的三角（只为形态，不参与编号） */
.triN{
  width:var(--size); height:var(--size);
  background:
    linear-gradient(180deg, rgba(255,255,255,.10), rgba(0,0,0,.0)),
    var(--grid),
    linear-gradient(135deg,#dfe7ff,#b9c9ff);
  border:2px solid rgba(255,255,255,.30);
  clip-path:polygon(50% 6%, 96% 94%, 4% 94%);
  transform-origin:50% 50%;
}
.nA{ left:calc(2*var(--size)); top:calc(0.6*var(--size)); transform:rotate(35deg)  scale(.85); }
.nB{ left:calc(2.4*var(--size)); top:calc(1.4*var(--size)); transform:rotate(80deg)  scale(.85); }
.nC{ left:calc(1.8*var(--size)); top:calc(2.2*var(--size)); transform:rotate(120deg) scale(.85); }
.nD{ left:calc(1.0*var(--size)); top:calc(2.6*var(--size)); transform:rotate(160deg) scale(.85); }
.nE{ left:calc(0.2*var(--size)); top:calc(2.2*var(--size)); transform:rotate(200deg) scale(.85); }
.nF{ left:calc(-0.2*var(--size));top:calc(1.4*var(--size)); transform:rotate(245deg) scale(.85); }
.nG{ left:calc(0.2*var(--size)); top:calc(0.6*var(--size)); transform:rotate(285deg) scale(.85); }
.nH{ left:calc(1.0*var(--size)); top:calc(0.2*var(--size)); transform:rotate(325deg) scale(.85); }

/* 走步高亮 */
@keyframes pulse {
  0%   { box-shadow:0 0 0 0 rgba(99,102,241,.6); border-color:rgba(99,102,241,.95); }
  100% { box-shadow:0 0 0 14px rgba(99,102,241,0); border-color:rgba(255,255,255,.35); }
}
.cell.active{ animation:pulse .36s ease-out; border-color:rgba(99,102,241,.95)!important; }
.cell.current{ border-color:#60a5fa !important; box-shadow:0 0 0 4px rgba(96,165,250,.25) inset; }

/* 弹窗 */
.modal[hidden]{display:none!important}
.modal{position:fixed; inset:0; display:grid; place-items:center; z-index:50}
.modal__backdrop{position:absolute; inset:0; background:rgba(0,0,0,.45); backdrop-filter:blur(2px)}
.modal__card{
  position:relative; z-index:1; width:min(720px,92vw); min-height:220px;
  background:#0b0f1a; border:1px solid #2a3248; color:#e5e7eb;
  border-radius:16px; overflow:hidden; display:grid; grid-template-columns:40% 1fr;
  box-shadow:0 30px 60px rgba(0,0,0,.5)
}
@media (max-width:720px){ .modal__card{ grid-template-columns:1fr } }
.modal__media{ background:linear-gradient(135deg,#dbeafe,#fde68a); min-height:180px }
.modal__body{ padding:1rem 1.25rem }
.modal__body h3{ margin:.25rem 0 }
.modal__body p{ color:#c7ccd8; margin:.25rem 0 }
.modal__close{ position:absolute; right:10px; top:6px; width:36px; height:36px; border-radius:10px;
  border:1px solid #3b4460; background:#12182a; color:#e5e7eb; cursor:pointer }
.btn{ border:1px solid #3b4460; background:#12182a; color:#e5e7eb; border-radius:10px; padding:.5rem .9rem; display:inline-block; text-decoration:none }
